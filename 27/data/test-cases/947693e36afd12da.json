{"uid":"947693e36afd12da","name":"KAFKA: Заполнение userdata исключая auth","fullName":"tests.kafka_tests.test_kafka#test_message_should_be_produced_to_userdata_after_kafka_event","historyId":"37d0a92236ad9bbc9a43e1bf5568b00e","time":{"start":1771441718014,"stop":1771441718824,"duration":810},"status":"broken","statusMessage":"AttributeError: 'NoneType' object has no attribute 'username'","statusTrace":"user_data = UserData(username='automobile_1925', password='DtLz[^W;', submit_password='DtLz[^W;', first_name='Дарья')\nkafka = <clients.kafka_client.KafkaClient object at 0x7f5c6f973e80>\nauthority_db = <database.authority_db.AuthorityDb object at 0x7f5c71963790>\nuser_db = <database.user_db.UserDb object at 0x7f5c6f973a30>\n\n    @id(\"600002\")\n    @title(\"KAFKA: Заполнение userdata исключая auth\")\n    @tag(\"KAFKA\")\n    def test_message_should_be_produced_to_userdata_after_kafka_event(user_data, kafka, authority_db, user_db):\n        username = user_data.username\n        print(\"username\", username)\n        kafka.sent_event(KAFKA_TOPIC, username)\n    \n        with step(\"Check new record in auth db\"):\n            assert authority_db.get_user_by_user_name(username) is None\n    \n        with step(\"Check new record in userdata db\"):\n>           assert user_db.get_user_by_username(username).username == username\nE           AttributeError: 'NoneType' object has no attribute 'username'\n\ntests/kafka_tests/test_kafka.py:42: AttributeError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"[S] Base Url","time":{"start":1771441708364,"stop":1771441708364,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Pytestconfig","time":{"start":1771441708365,"stop":1771441708365,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Delete Output Dir","time":{"start":1771441708365,"stop":1771441708365,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S]  Verify Url","time":{"start":1771441708365,"stop":1771441708365,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Envs","time":{"start":1771441708365,"stop":1771441708368,"duration":3},"status":"passed","steps":[],"attachments":[{"uid":"e29564b7e29a91ac","name":"envs.json","source":"e29564b7e29a91ac.json","type":"application/json","size":511}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"[S] Authority Db","time":{"start":1771441708369,"stop":1771441708537,"duration":168},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Auth Client","time":{"start":1771441708538,"stop":1771441708538,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Registration User","time":{"start":1771441708538,"stop":1771441710159,"duration":1621},"status":"passed","steps":[{"name":"GET /register","time":{"start":1771441708573,"stop":1771441709515,"duration":942},"status":"passed","steps":[],"attachments":[{"uid":"ec8e497472d9c7d3","name":"Request","source":"ec8e497472d9c7d3.html","type":"text/html","size":2053},{"uid":"e9927fcdee3e54b8","name":"9ce2904f-f647-4b9e-8903-bd13da18633c-attachment.txt","source":"e9927fcdee3e54b8.txt","type":"text/plain","size":3731}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"POST /register","time":{"start":1771441709522,"stop":1771441710159,"duration":637},"status":"passed","steps":[],"attachments":[{"uid":"40cd454cc2df7d5d","name":"Request","source":"40cd454cc2df7d5d.html","type":"text/html","size":2710},{"uid":"2aa5106fe8a3694c","name":"dc9a428a-6a50-4a33-9c92-3904d6f511e9-attachment.txt","source":"2aa5106fe8a3694c.txt","type":"text/plain","size":2279}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":false,"attachmentsCount":4,"hasContent":true,"attachmentStep":false},{"name":"[S] Kafka","time":{"start":1771441717789,"stop":1771441717793,"duration":4},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] User Db","time":{"start":1771441718011,"stop":1771441718011,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[F] Person Generator","time":{"start":1771441718011,"stop":1771441718013,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[F] User Data","time":{"start":1771441718013,"stop":1771441718013,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"AttributeError: 'NoneType' object has no attribute 'username'","statusTrace":"user_data = UserData(username='automobile_1925', password='DtLz[^W;', submit_password='DtLz[^W;', first_name='Дарья')\nkafka = <clients.kafka_client.KafkaClient object at 0x7f5c6f973e80>\nauthority_db = <database.authority_db.AuthorityDb object at 0x7f5c71963790>\nuser_db = <database.user_db.UserDb object at 0x7f5c6f973a30>\n\n    @id(\"600002\")\n    @title(\"KAFKA: Заполнение userdata исключая auth\")\n    @tag(\"KAFKA\")\n    def test_message_should_be_produced_to_userdata_after_kafka_event(user_data, kafka, authority_db, user_db):\n        username = user_data.username\n        print(\"username\", username)\n        kafka.sent_event(KAFKA_TOPIC, username)\n    \n        with step(\"Check new record in auth db\"):\n            assert authority_db.get_user_by_user_name(username) is None\n    \n        with step(\"Check new record in userdata db\"):\n>           assert user_db.get_user_by_username(username).username == username\nE           AttributeError: 'NoneType' object has no attribute 'username'\n\ntests/kafka_tests/test_kafka.py:42: AttributeError","steps":[{"name":"Check new record in auth db","time":{"start":1771441718796,"stop":1771441718808,"duration":12},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Check new record in userdata db","time":{"start":1771441718808,"stop":1771441718823,"duration":15},"status":"broken","statusMessage":"AttributeError: 'NoneType' object has no attribute 'username'\n","statusTrace":"  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-tests-python/tests/kafka_tests/test_kafka.py\", line 42, in test_message_should_be_produced_to_userdata_after_kafka_event\n    assert user_db.get_user_by_username(username).username == username\n","steps":[],"attachments":[{"uid":"fd52b79b92502f87","name":"select niffler-userdata","source":"fd52b79b92502f87.txt","type":"text/plain","size":27},{"uid":"d9fb669486ddcb91","name":"select niffler-userdata","source":"d9fb669486ddcb91.txt","type":"text/plain","size":23},{"uid":"cee5bb67aaabe51b","name":"show niffler-userdata","source":"cee5bb67aaabe51b.txt","type":"text/plain","size":32},{"uid":"fbf6dacaad2a85b6","name":"SELECT niffler-userdata","source":"fbf6dacaad2a85b6.txt","type":"text/plain","size":172}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":4,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":true,"attachmentsCount":4,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"kafka::0","time":{"start":1771441764044,"stop":1771441764053,"duration":9},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"epic","value":"Kafka"},{"name":"as_id","value":"600002"},{"name":"tag","value":"KAFKA"},{"name":"host","value":"runnervmjduv7"},{"name":"thread","value":"8925-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.kafka_tests.test_kafka"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":2,"skipped":0,"passed":0,"unknown":0,"total":2},"items":[{"uid":"3573d5b96b4d4e88","reportUrl":"https://AlexLumen.github.io/niffler-py-st3/26/#testresult/3573d5b96b4d4e88","status":"broken","statusDetails":"AttributeError: 'NoneType' object has no attribute 'username'","time":{"start":1771352549325,"stop":1771352549617,"duration":292}}]},"tags":["KAFKA"]},"source":"947693e36afd12da.json","parameterValues":[]}